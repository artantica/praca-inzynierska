\chapter{Eksperymenty}
\thispagestyle{chapterBeginStyle}
\label{eksperymenty}

Po zaprezentowaniu projektu i implementacji aplikacja podmiany twarzy, ten rozdział przedstawia opis i wyniki testów przeprowadzonych na wybranych filmach w celu zbadania wpływu czasu uczenia, rozmiaru zbioru danych oraz jakości nagrania na skuteczność aplikacji. Przedstawione zostały również wyniki eksperymentów wykorzystania aplikacji w czasie rzeczywistym.

\section{Środowisko}

\subsection{Colabolatory}
\label{colabolatory}
Proces wydobycia danych oraz treningu miał miejsce przy użycia narzędzia Google Reasearch \texttt{Colaboratory} (w skrócie "\texttt{Colab}"). Opiera się ono na prywatnych maszynach wirtualnych oferowanych przez firmę Google wraz z dostępem do fizycznych kart graficznych. Dostępne GPU to różne modele kart NVIDIA: K80s, T4s, P4s lub P100s. Użytkownik końcowy nie ma wpływu na konkretny model jaki zostaje przypisany do danej instancji. Ilość dostępnej pamięci RAM zmienia się dynamicznie w zależności od jej zużycia.

\subsection{Środowisko lokalne}
\label{sprzet-srodowisko-lokalne}
Projekt tworzony był również na środowisku lokalnym, którym był Macbook z rocznika 2019. Posiadał on 32 GB pamięci RAM o częstotliwości 2667 MHz oraz ośmiordzeniowy procesor Intel Core i9 o taktowaniu 2,3 GHz. Z uwagi na posiadanie karty graficznej firmy AMD, nie była ona wykorzystywana w treningu modeli - wynika to z braku odpowiedniej współpracy sprzętu z oprogramowaniem. Jednakże, sprzęt ten był wykorzystywany do testowania konwersji wideo na żywo z powodu braku takiej możliwości na środowisku Colab.

\section{Szczegóły testów}
W przeprowadzonych podczas treningu eksperymentach, wykorzystywana jest stała \texttt{batch\_size} równa 64, chyba, że zaznaczono inaczej.

Eksperymenty zostały przeprowadzone zarówno na wcześniej nagranych filmach, jak i na tych nagrywanych i konwertowanych w czasie rzeczywistym.

Filmy wykorzystane w eksperymentach zostały pobrane z platformy YouTube lub nagrano je osobiście.

W eksperymentach zostały użyte zdjęcia osób przedstawionych w tabeli \ref{table:people}:
\begin{table}[htbp]
    \centering
    \begin{tabular}{|c|c|c|}
        \hline
        Zdjęcie & Imię i nazwisko & Liczba twarzy  \\
        \hline
        \raisebox{-\totalheight}{\includegraphics[width=20mm, height=23mm]{images/people/JenifferAniston4.jpg}} & Jeniffer Aniston & 4798 \\
        \hline
        \raisebox{-\totalheight}{\includegraphics[width=20mm, height=23mm]{images/people/JenniferLawrence01.jpg}}
         & Jeniffer Lawrence & 2167 \\
         \hline
        \raisebox{-\totalheight}{\includegraphics[width=20mm, height=23mm]{images/people/EllenDegeneres4.jpg}} & Ellen DeGeneres & 5799 \\
        \hline
        \raisebox{-\totalheight}{\includegraphics[width=20mm, height=23mm]{images/people/LeonardoDiCaprio04.jpg}} & Leonardo DiCaprio & 4510 \\
        \hline
        \raisebox{-\totalheight}{\includegraphics[width=20mm, height=23mm]{images/people/StephenColbert01.jpg}} & Stephen Colbert & 5063 \\
        \hline
        \raisebox{-\totalheight}{\includegraphics[width=20mm, height=23mm]{images/people/KarolinaAntonik08.jpg}} & Karolina Antonik & 11149 \\
        \hline
        \raisebox{-\totalheight}{\includegraphics[width=20mm, height=23mm]{images/people/Arkadiusz_Maruszczak.jpg}} & Arkadiusz Maruszczak & 5995 \\
        \hline
    \end{tabular}
    \caption{Osoby wykorzystywane w eksperymentach wraz z liczbą zdjęć twarzy.}
    \label{table:people}
\end{table}

\section{Liczba danych}
Zostały przeprowadzone testy dla modelu oryginalnego w celu sprawdzenia jak ilość danych twarzy wpływa na jakość podmiany. Przetestowano ilości twarzy z przedziału $\{100, 500, 1000, 2000\}$ ucząc model podmieniać twarz Karoliny Antonik na twarz Jeniffer Aniston. Wytrenowano 4 modele, które uczone były na takiej samej liczbie twarzy z podanego przedziału (patrz rysunki \ref{results:aniston-100-100}, \ref{results:aniston-500-500}, \ref{results:aniston-1000-1000}, \ref{results:aniston-2000-2000} dla wyników podmiany twarzy nagranego wcześniej filmu i rysunki \ref{results:aniston-live-100-100}, \ref{results:aniston-live-500-500}, \ref{results:aniston-live-1000-1000}, \ref{results:aniston-live-2000-2000} nagrane podczas transmisji na żywo) oraz dwa modele, które zostały wytrenowane na różnej liczbie twarzy $\{100, 1000\}$ (patrz rysunki \ref{results:aniston-100-1000} i \ref{results:aniston-1000-100} dla wyników podmiany twarzy nagranego wcześniej filmu i rysunki \ref{results:aniston-live-100-1000} i \ref{results:aniston-live-1000-100}).

Wraz ze wzrostem liczby twarzy można zauważyć polepszającą się jakość, w szczególności po większej liczbie iteracji. Zgadza się to z opinią prezentowaną na forum Faceswap \cite{faceswap-forum}.
% TODO słowo o różnych ilościach

Co więcej wzrost liczby twarzy zwiększa czas procesowania, nie tylko podczas wydobywania tych twarzy ze zdjęć lub filmów, ale także podczas treningu, kiedy to wszystkie twarze muszą zostać załadowane za każdym razem, gdy uruchomiony zostaje trening. Na trenowanym środowisku Colabolatory (patrz rozdział \ref{colabolatory}) załadowanie ponad 11 tysięcy twarzy zajmuje około 3 minut. Powoduje to, że w przypadku posiadania po obu stronach podobnie dużej ilości danych wejściowych, czas odczytu zająłby 6 minut.

Porównując rysunki \ref{results:aniston-100-100}, \ref{results:aniston-live-100-100}, \ref{results:aniston-2000-2000} i \ref{results:aniston-live-2000-2000} można też zauważyć, że za mała liczba danych daje słabsze efekty. Co więcej w kolejnych iteracjach dla 100 twarzy nie widać polepszenia jakości podmienionej twarzy, co wskazuje, że tak małe liczby danych wejściowych nie pozwolą wytrenować modelu zapewniającego zadowalające efekty.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth, height=0.75\paperheight]{images/06_Eksperymenty/Karolina/Aniston/O_100_100/Karolina_2_000556_text_double.jpg}
    \caption{Podmiana twarzy Karoliny Antonik na twarz Jeniffer Aniston dla kolejnych iteracji (z przedziału 25000 do 300000) dla modelu oryginalnego wytrenowanego na 100 twarzach po obu stronach dla wcześniej nagranego filmu.}
    \label{results:aniston-100-100}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_100_aniston_100_original_12_comparison.png}
    \caption{Podmiana twarzy Karoliny Antonik na twarz Jeniffer Aniston dla wybranych iteracji dla modelu oryginalnego wytrenowanego na 100 twarzach po obu stronach w czasie rzeczywistym.}
    \label{results:aniston-live-100-100}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth, height=0.75\paperheight]{images/06_Eksperymenty/Karolina/Aniston/O_500_500/Karolina_2_000556_text_double (1).jpg}
    \caption{Podmiana twarzy Karoliny Antonik na twarz Jeniffer Aniston dla kolejnych iteracji (z przedziału 25000 do 175000) dla modelu oryginalnego wytrenowanego na 500 twarzach po obu stronach dla wcześniej nagranego filmu.}
    \label{results:aniston-500-500}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_500_jeniffer_500_original_12_comparison.png}
    \caption{Podmiana twarzy Karoliny Antonik na twarz Jeniffer Aniston dla wybranych iteracji dla modelu oryginalnego wytrenowanego na 500 twarzach po obu stronach w czasie rzeczywistym.}
    \label{results:aniston-live-500-500}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth, height=0.75\paperheight]{images/06_Eksperymenty/Karolina/Aniston/O_1000_1000/Karolina_2_000556_text_double.jpg}
    \caption{Podmiana twarzy Karoliny Antonik na twarz Jeniffer Aniston dla kolejnych iteracji (z przedziału 25000 do 175000) dla modelu oryginalnego wytrenowanego na 1000 twarzach po obu stronach dla wcześniej nagranego filmu.}
    \label{results:aniston-1000-1000}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_1000_aniston_1000_original_12_comparison.png}
    \caption{Podmiana twarzy Karoliny Antonik na twarz Jeniffer Aniston dla wybranych iteracji dla modelu oryginalnego wytrenowanego na 1000 twarzach po obu stronach w czasie rzeczywistym.}
    \label{results:aniston-live-1000-1000}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/Aniston/O_2000_2000/Karolina_2_000556_text_double.jpg}
    \caption{Podmiana twarzy Karoliny Antonik na twarz Jeniffer Aniston dla kolejnych iteracji (z przedziału 25000 do 150000) dla modelu oryginalnego wytrenowanego na 2000 twarzach po obu stronach dla wcześniej nagranego filmu.}
    \label{results:aniston-2000-2000}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_2000_aniston_2000_original_12_comparison.png}
    \caption{Podmiana twarzy Karoliny Antonik na twarz Jeniffer Aniston dla wybranych iteracji dla modelu oryginalnego wytrenowanego na 2000 twarzach po obu stronach w czasie rzeczywistym.}
    \label{results:aniston-live-2000-2000}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth, height=0.75\paperheight]{images/06_Eksperymenty/Karolina/Aniston/O_100_1000/Karolina_2_000556_text_double.jpg}
    \caption{Podmiana twarzy Karoliny Antonik na twarz Jeniffer Aniston dla kolejnych iteracji (z przedziału 25000 do 200000) dla modelu oryginalnego wytrenowanego na 100 twarzach po stronie A i 1000 twarzach po stronie B dla wcześniej nagranego filmu}
    \label{results:aniston-100-1000}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_100_aniston_1000_12_comparison.png}
    \caption{Podmiana twarzy Karoliny Antonik na twarz Jeniffer Aniston dla wybranych iteracji dla modelu oryginalnego wytrenowanego na 100 twarzach po stronie A i 1000 twarzach po stronie B w czasie rzeczywistym.}
    \label{results:aniston-live-100-1000}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/Aniston/O_1000_100/Karolina_2_000556_text_double.jpg}
    \caption{Podmiana twarzy Karoliny Antonik na twarz Jeniffer Aniston dla kolejnych iteracji (z przedziału 25000 do 100000) dla modelu oryginalnego wytrenowanego na 1000 twarzach po stronie A i 100 twarzach po stronie B dla wcześniej nagranego filmu}
    \label{results:aniston-1000-100}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_1000_aniston_100_original_12_comparison.png}
    \caption{Podmiana twarzy Karoliny Antonik na twarz Jeniffer Aniston dla wybranych iteracji dla modelu oryginalnego wytrenowanego na 1000 twarzach po stronie A i 100 twarzach po stronie B w czasie rzeczywistym.}
    \label{results:aniston-live-1000-100}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TESTY MODELI %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Rodzaje modeli}
Poniżej przedstawione zostaną wyniki podmiany twarzy różnych osób na nagranych filmach przy wykorzystaniu modeli opisanych w rozdziale \ref{models}.

%%%%%%%%%%%%%%%%%%%% ORIGINAL %%%%%%%%%%%%%%%%%%%%
\subsection{Model oryginalny}
Model oryginalny został przetestowany podczas podmian twarzy między Karoliną Antonik, a Jeniffer Aniston (rysunek \ref{results:aniston-original} i \ref{results:aniston-live-original} ), Jeniffer Lawrence (rysunek \ref{results:lawrence-original} i \ref{results:lawrence-live-original}), Ellen DeGeneres (rysunek \ref{results:ellen-original} i \ref{results:ellen-live-original}) oraz Leonardo DiCaprio (rysunek \ref{results:karo-loenardo-original} i \ref{results:karo-loenardo-live-original}).

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Aniston_Original_Karolina_2_000556.jpg}
    \caption{Podmiana na twarz Jeniffer Aniston dla wybranych iteracji przy użyciu modelu oryginalnego dla wcześniej nagranego filmu.}
    \label{results:aniston-original}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_jeniffer_original_12_comparison.png}
    \caption{Podmiana na twarz Jeniffer Aniston dla wybranych iteracji przy użyciu modelu oryginalnego dla czasu rzeczywistego.}
    \label{results:aniston-live-original}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Lawrence_Original_Karolina_2_000556.jpg}
    \caption{Podmiana na twarz Jeniffer Lawrence dla wybranych iteracji przy użyciu modelu oryginalnego dla wcześniej nagranego filmu.}
    \label{results:lawrence-original}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_lawrence_original_12_comparison.png}
    \caption{Podmiana na twarz Jeniffer Lawrence dla wybranych iteracji przy użyciu modelu oryginalnego w czasie rzeczywistym.}
    \label{results:lawrence-live-original}
\end{figure}

\begin{figure}[htbp]
    \centering
\includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Ellen_Original_Karolina_2_000556.jpg}
    \caption{Podmiana na twarz Ellen DeGeneres dla wybranych iteracji przy użyciu modelu oryginalnego dla wcześniej nagranego filmu.}
    \label{results:ellen-original}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_ellen_original_12_comparison.png}
    \caption{Podmiana na twarz Ellen DeGeneres dla wybranych iteracji przy użyciu modelu oryginalnego w czasie rzeczywistym.}
    \label{results:ellen-live-original}
\end{figure}

\begin{figure}[htbp]%TODO
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Leonardo_Original_Karolina_2_000556.jpg}
    \caption{Podmiana na twarz Leonardo DiCaprio dla wybranych iteracji przy użyciu modelu oryginalnego dla wcześniej nagranego filmu.}
    \label{results:karo-loenardo-original}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_leonardo_original_12_comparison.png}
    \caption{Podmiana na twarz Leonardo DiCaprio dla wybranych iteracji przy użyciu modelu oryginalnego w czasie rzeczywistym.}
    \label{results:karo-loenardo-live-original}
\end{figure}

%%%%%%%%%%%%%%%%%%%% REALFACE %%%%%%%%%%%%%%%%%%%%

\subsection{Model realface}
Model realface został przetestowany podczas podmian twarzy między Karoliną Antonik a Jeniffer Aniston (rysunek \ref{results:aniston-realface} i \ref{results:aniston-live-realface} ), Jeniffer Lawrence (rysunek \ref{results:lawrence-realface} oraz \ref{results:lawrence-live-realface}).
% oraz Ellen DeGeneres (rysunek \ref{results:ellen-realface}).

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Aniston_Realface_Karolina_2_000556.jpg}
    \caption{Podmiana na twarz Jeniffer Aniston dla wybranych kolejnych iteracji przy użyciu modelu realface dla wcześniej nagranego filmu.}
    \label{results:aniston-realface}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_jeniffer_realface_12_comparison.png}
    \caption{Podmiana na twarz Jeniffer Aniston dla wybranych iteracji przy użyciu modelu realface dla czasu rzeczywistego.}
    \label{results:aniston-live-realface}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Lawrence_Realface_Karolina_2_000556.jpg}
    \caption{Podmiana na twarz Jeniffer Lawrence dla wybranych iteracji przy użyciu modelu realface dla wcześniej nagranego filmu.}
    \label{results:lawrence-realface}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_lawrence_realface_12_comparison.png}
    \caption{Podmiana na twarz Jeniffer Lawrence dla wybranych iteracji przy użyciu modelu realface w czasie rzeczywistym.}
    \label{results:lawrence-live-realface}
\end{figure}

% \begin{figure}[htbp]
%     \centering
%     \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Ellen_Realface_Karolina_2_000556.jpg}
%     \caption{Podmiana na twarz Ellen DeGeneres dla wybranych iteracji przy użyciu modelu realface dla wcześniej nagranego filmu.}
%     \label{results:ellen-realface}
% \end{figure}

% \begin{figure}[htbp]
%     \centering
%     \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/ellen}
%     \caption{Podmiana na twarz Ellen DeGeneres dla wybranych iteracji przy użyciu modelu realface w czasie rzeczywistym.}
%     \label{results:ellen-live-realface}
% \end{figure}

%%%%%%%%%%%%%%%%%%%% VILLAIN %%%%%%%%%%%%%%%%%%%%

\subsection{Model villain}
Model villain został przetestowany podczas podmian twarzy między Karoliną Antonik, a Jeniffer Aniston (rysunek \ref{results:aniston-villain} i \ref{results:aniston-live-villain} ), Jeniffer Lawrence (rysunek \ref{results:lawrence-villain} i \ref{results:lawrence-live-villain}), Ellen DeGeneres (rysunek \ref{results:ellen-villain}) oraz Leonardo DiCaprio (rysunek \ref{results:karo-loenardo-villain} i \ref{results:karo-loenardo-live-villain}).

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Ellen_Villain_Karolina_2_000556.jpg}
    \caption{Podmiana na twarz Jeniffer Aniston dla wybranych kolejnych iteracji przy użyciu modelu villain dla wcześniej nagranego filmu.}
    \label{results:aniston-villain}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_jeniffer_villain_12_comparison.png}
    \caption{Podmiana na twarz Jeniffer Aniston dla wybranych iteracji przy użyciu modelu villain dla czasu rzeczywistego.}
    \label{results:aniston-live-villain}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Lawrence_Villain_Karolina_2_000556.jpg}
    \caption{Podmiana na twarz Jeniffer Lawrence dla wybranych iteracji przy użyciu modelu villain dla wcześniej nagranego filmu.}
    \label{results:lawrence-villain}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_lawrence_villain_12_comparison.png}
    \caption{Podmiana na twarz Jeniffer Lawrence dla wybranych iteracji przy użyciu modelu villain w czasie rzeczywistym.}
    \label{results:lawrence-live-villain}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Ellen_Villain_Karolina_2_000556.jpg}
    \caption{Podmiana na twarz Ellen DeGeneres dla wybranych iteracji przy użyciu modelu villain dla wcześniej nagranego filmu.}
    \label{results:ellen-villain}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_ellen_villain_12_comparison.png}
    \caption{Podmiana na twarz Ellen DeGeneres dla wybranych iteracji przy użyciu modelu villain w czasie rzeczywistym.}
    \label{results:ellen-live-villain}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Lawrence_Villain_Karolina_2_000556.jpg}
    \caption{Podmiana na twarz Leonardo DiCaprio dla wybranych iteracji przy użyciu modelu villain dla wcześniej nagranego filmu.}
    \label{results:karo-loenardo-villain}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_leonardo_villain_12_comparison.png}
    \caption{Podmiana na twarz Leonardo DiCaprio dla wybranych iteracji przy użyciu modelu villain w czasie rzeczywistym.}
    \label{results:karo-loenardo-live-villain}
\end{figure}

%%%%%%%%%%%%%%%%%%%% DFL %%%%%%%%%%%%%%%%%%%%

\subsection{Model DFL-SAE}
Model dfl-sae został przetestowany podczas podmian twarzy między Karoliną Antonik, a Jeniffer Aniston (rysunek \ref{results:aniston-dfl-sae} i \ref{results:aniston-live-dfl-sae} ), Jeniffer Lawrence (rysunek \ref{results:lawrence-dfl-sae} i \ref{results:lawrence-live-dfl-sae}) oraz Ellen DeGeneres (rysunek \ref{results:ellen-dfl-sae} i \ref{results:ellen-live-dfl-sae}).

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Aniston_Dfl_Karolina_2_000556.jpg}
    \caption{Podmiana na twarz Jeniffer Aniston dla wybranych kolejnych iteracji przy użyciu modelu dfl-sae dla wcześniej nagranego filmu.}
    \label{results:aniston-dfl-sae}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_jeniffer_dfl_12_comparison.png}
    \caption{Podmiana na twarz Jeniffer Aniston dla wybranych iteracji przy użyciu modelu dfl-sae dla czasu rzeczywistego.}
    \label{results:aniston-live-dfl-sae}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Lawrence_Dfl_Karolina_2_000556.jpg}
    \caption{Podmiana na twarz Jeniffer Lawrence dla wybranych iteracji przy użyciu modelu dfl-sae dla wcześniej nagranego filmu.}
    \label{results:lawrence-dfl-sae}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_lawrence_dfl_12_comparison.png}
    \caption{Podmiana na twarz Jeniffer Lawrence dla wybranych iteracji przy użyciu modelu dfl-sae w czasie rzeczywistym.}
    \label{results:lawrence-live-dfl-sae}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Ellen_Dfl_Karolina_2_000556.jpg}
    \caption{Podmiana na twarz Ellen DeGeneres dla wybranych iteracji przy użyciu modelu dfl-sae dla wcześniej nagranego filmu.}
    \label{results:ellen-dfl-sae}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/karolina_ellen_dfl_sae_12_comparison.png}
    \caption{Podmiana na twarz Ellen DeGeneres dla wybranych iteracji przy użyciu modelu dfl-sae w czasie rzeczywistym.}
    \label{results:ellen-live-dfl-sae}
\end{figure}

\subsection{Porównanie modeli}
Po obserwacji rezultatów zarówno z nagranych wcześniej filmów jak i z tych nagrywanych w czasie rzeczywistym, zauważyć można, że model\textbf{villain} osiąga najlepsze rezultaty. Jednakże wytrenowanie tego modelu wiąże się z większym zużyciem GPU oraz dłuższym czasem treningu, gdyż lepsze wyniki osiąga się po większej liczbie iteracji.

Na rysunkach \ref{results:aniston-comparison} i \ref{results:aniston-live-comparison} można zobaczyć porównanie rezultatów podmiany twarzy Karoliny Antonik na twarzy Jeniffer Aniston dla modeli: \textbf{oryginalnego}, \textbf{villain}, \textbf{realface} oraz \textbf{dfl-sae}. Jeniffer Aniston ma silną linie szczęki i wystające policzki, co może sprawiać trudności podczas podmiany na twarzy o innym kształcie. Podmiana wykonana za pomocą modelu villain wyszła bardzo realistycznie, podobnie jak w przypadku modelu oryginalnego. Model realface poradził sobie najgorzej i twarz podmieniona za jego pomocą wydaje się być niewyraźna, nawet w przypadku konwersji w czasie rzeczywistym na rysunku \ref{results:aniston-live-comparison}, gdzie jakość obrazu uzyskanego z kamerki internetowej jest gorsza od jakości uzyskanej w nagranym wcześniej filmie.

Na rysunkach \ref{results:lawrence-comparison} i \ref{results:lawrence-live-comparison} można zobaczyć porównanie rezultatów podmiany twarzy Karoliny Antonik na twarzy Jeniffer Lawrence dla modeli: \textbf{oryginalnego}, \textbf{villain}, \textbf{realface} oraz \textbf{dfl-sae}.

Na rysunkach \ref{results:ellen-comparison} i \ref{results:ellen-live-comparison} można zobaczyć porównanie rezultatów podmiany twarzy Karoliny Antonik na twarzy Ellen DeGeneres dla modeli: \textbf{oryginalnego}, \textbf{villain}, \textbf{realface} oraz \textbf{dfl-sae}.

Na rysunkach \ref{results:leonardo-comparison} i \ref{results:leonardo-live-comparison} można zobaczyć porównanie rezultatów podmiany twarzy Karoliny Antonik na twarzy Leonarda DiCaprio dla modeli: \textbf{oryginalnego} oraz \textbf{villain}.

%%%%%%%%%%%%%%%%%%%% JENIFFER ANISTON %%%%%%%%%%%%%%%%%%%%
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Aniston_comparison_model.jpg}
    \caption{Porównanie wyników podmiany twarzy Karoliny Antonik na twarz Jeniffer Aniston na nagranym poprzednio filmie.}
    \label{results:aniston-comparison}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/jeniffer_comparison_live_model.jpg}
    \caption{Porównanie wyników podmiany twarzy Karoliny Antonik na twarz Jeniffer Aniston w czasie rzeczywistym.}
    \label{results:aniston-live-comparison}
\end{figure}

%%%%%%%%%%%%%%%%%%%% JENIFFER LAWRENCE %%%%%%%%%%%%%%%%%%%%
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Lawrence_comparison_model.jpg}
    \caption{Porównanie wyników podmiany twarzy Karoliny Antonik na twarz Jeniffer Lawrence na nagranym poprzednio filmie.}
    \label{results:lawrence-comparison}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/lawrence_comparison_live_model.jpg}
    \caption{Porównanie wyników podmiany twarzy Karoliny Antonik na twarz Jeniffer Lawrence w czasie rzeczywistym.}
    \label{results:lawrence-live-comparison}
\end{figure}

%%%%%%%%%%%%%%%%%%%% ELLEN DEGENERES %%%%%%%%%%%%%%%%%%%%
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Ellen_comparison_model.jpg}
    \caption{Porównanie wyników podmiany twarzy Karoliny Antonik na twarz Ellen DeGeneres na nagranym poprzednio filmie.}
    \label{results:ellen-comparison}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/ellen_comparison_live_model.jpg}
    \caption{Porównanie wyników podmiany twarzy Karoliny Antonik na twarz Ellen DeGeneres w czasie rzeczywistym.}
    \label{results:ellen-live-comparison}
\end{figure}

%%%%%%%%%%%%%%%%%%%% LEONARDO DICAPRIO %%%%%%%%%%%%%%%%%%%%
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/video/Leonardo_comparison_model.jpg}
    \caption{Porównanie wyników podmiany twarzy Karoliny Antonik na twarz Leonardo Dicaprio na nagranym poprzednio filmie.}
    \label{results:leonardo-comparison}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Karolina/live/leonardo_comparison_live_model.jpg}
    \caption{Porównanie wyników podmiany twarzy Karoliny Antonik na twarz Leonardo Dicaprio w czasie rzeczywistym.}
    \label{results:leonardo-live-comparison}
\end{figure}

Ciekawe wyniki uzyskano podczas podmiany innej twarzy (Arkadiusz Maruszczak), który ma brodę w momencie nagrywania filmów. Żadnemu z modeli nie udało się w sposób realistyczny zamienić twarzy w taki sposób, aby broda wyglądała naturalnie. W przypadku podmiany na twarz Leonarda DiCaprio, którego wyniki można zobaczyć na na rysunku \ref{results:arek-leonardo-comparison} model oryginalny wyszedł najmniej realistycznie, podczas gdy modele realface oraz dfl-sae wygenerował najlepszy i najbardziej wyraźny obraz.  W tym wypadku model villain dał twarz lekko zamazaną, szczególnie w okolicach oczu.
W przypadku podmiany na twarz Stephena Colberta dodatkowym utrudnieniem są okulary, które można zobaczyć na rysunku \ref{results:arek-colbert-comparison}. Wszystkie obrazy wejściowe twarzy do trenowania tych modeli miały okulary. W tym wypadku model oryginalny oraz realface dały najbardziej niewyraźnie i nienaturalne efekty. Podmiany za pomocą modeli villain i dfl-sae są bardziej przekonujące, jednakże w okolicy brody można zobaczyć granicę między podmienioną twarzą a oryginalną.

%%%%%%%%%%%%%%%%%%%% ARKADIUSZ MARUSZCZAK %%%%%%%%%%%%%%%%%%%%
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Arek/Leonardo_comparison_model.jpg}
    \caption{Porównanie wyników podmiany twarzy Karoliny Antonik na twarz Leonardo DiCaprio w czasie rzeczywistym.}
    \label{results:arek-leonardo-comparison}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{images/06_Eksperymenty/Arek/Colbert_comparison_model.jpg}
    \caption{Porównanie wyników podmiany twarzy Arkadiusza Maruszczaka na twarz Stephena Colberta na nagranym poprzednio filmie.}
    \label{results:arek-colbert-comparison}
\end{figure}

\subsection{Wnioski}